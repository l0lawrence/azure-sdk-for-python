# coding=utf-8
# --------------------------------------------------------------------------
# Copyright (c) Microsoft Corporation. All rights reserved.
# Licensed under the MIT License. See License.txt in the project root for license information.
# Code generated by Microsoft (R) AutoRest Code Generator.
# Changes may cause incorrect behavior and will be lost if the code is regenerated.
# --------------------------------------------------------------------------

from typing import Any, Dict, Optional, TypeVar, Generic, Mapping # pylint: disable=unused-import


PropertiesT = TypeVar("PropertiesT")
PathParamsT = TypeVar("PathParamsT")
TResourceType = TypeVar("TResourceType", bound="ResourceType[Any, Mapping[str, str]]")


class ResourceType(Generic[PropertiesT, PathParamsT]):
    """Common ARM resource fields."""
    _validation = {
        "id": {"readonly": True},
        "name": {"readonly": True},
        "type": {"readonly": True},
        "properties": {"readonly": False}
    }

    # Default URL template - should be overridden by subclasses
    _url_template = (
        "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/"
        "providers/{resourceProvider}/{resourceType}/{resourceName}"
    )

    _list_url_template = _url_template

    def __init__(self, **kwargs: Any) -> None:
        super().__init__(**kwargs)
        # Common ARM identity fields
        self.resource_group_name: str = kwargs.get("resource_group_name", "")
        self.resource_name: str = kwargs.get("resource_name", "")
        self.id = None
        self.name = None
        self.type = None
        self.properties: Optional[PropertiesT] = None

    @classmethod
    def get_operation_url( # pylint: disable=unused-argument
        cls,
        operation: str,
        subscription_id: str,
        url_params: PathParamsT,
    ) -> str:
        """Return the URL template for the given operation.

        Base resources only support ``read`` and ignore subscription/params in the
        template construction. Subclasses should override when they need operation-
        specific templates.

        :param str operation: Operation name (e.g. "read").
        :param str subscription_id: Subscription identifier.
        :param PathParamsT url_params: URL parameters required by the resource type.
        :return: URL template string.
        :rtype: str
        """
        if operation != "read":
            raise ValueError(f"Unsupported operation '{operation}' for {cls.__name__}")
        return cls._url_template

    @classmethod
    def from_response(
        cls, data_dict: Dict[str, Any], **kwargs: Any
    ) -> "ResourceType":
        """Create instance from API response data and request parameters.

        :param cls: The resource type class
        :type cls: Type[TResourceType]
        :param data_dict: The response data dictionary from Azure API
        :type data_dict: Dict[str, Any]
        :return: Created instance of the resource type
        :rtype: TResourceType
        """
        properties = data_dict.get('properties', {})

        # Create instance with constructor parameters from kwargs
        instance = cls(**kwargs, properties=properties)

        # Set response data attributes
        instance.id = data_dict.get('id')
        instance.name = data_dict.get('name')
        instance.type = data_dict.get('type')

        return instance

    def to_dict(self) -> Dict[str, Any]:
        """Convert the resource to a dictionary for API requests.
        
        :return: Dictionary representation of the resource
        :rtype: Dict[str, Any]
        """
        return {
            "properties": self.properties,
        }

    @classmethod
    def get_action_url(
        cls,
        action: str,
        subscription_id: str,
        url_params: PathParamsT,
    ) -> str:
        """Get the URL for a resource action (POST operation).
        
        Base implementation raises an error. Subclasses should override to provide
        action-specific URL templates.
        
        :param str action: The action name
        :param str subscription_id: Subscription identifier
        :param PathParamsT url_params: URL parameters required by the resource type
        :return: Formatted URL for the action
        :raises ValueError: If action is not supported
        :rtype: str
        """
        raise ValueError(f"Actions not supported for {cls.__name__}")

    @classmethod
    def build_instance_path_arguments_from_params( # pylint: disable=name-too-long
        cls,
        *,
        subscription_id: str,
        url_params: PathParamsT, # pylint: disable=unused-argument
    ) -> Dict[str, Any]:
        """Build path arguments dictionary from URL parameters.

        Base resources only use subscription ID. Subclasses should override when
        they need additional path arguments.

        :keyword str subscription_id: Subscription identifier.
        :keyword PathParamsT url_params: URL parameters required by the resource type.
        :return: Dictionary of path arguments.
        :rtype: Dict[str, Any]
        """
        return {
            "subscriptionId": subscription_id,
        }
